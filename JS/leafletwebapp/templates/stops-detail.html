<html>
        {% load leaflet_tags %}
        {% load static %}
<head>

        {% leaflet_css %}
    {% leaflet_js %}
    

    <!-- <style>
        html, body { height: 100%; width: 99%; margin: 10; }
        div.one{
            height: 100%;
            width: 100% 
        }

        </style>	-->
        <style>.leaflet-container-default {
            height: 80%;
            width: 80%;
        }</style>
        <script type="text/javascript" src="{% static 'dist/leaflet.ajax.js' %}" >	</script>

</head>
<body>
            <script type="text/javascript">
            function map_points(map,options,mypara)
            {
                //particular-bus
                console.log(mypara)
                var datapoints = new L.GeoJSON.AJAX("{% url 'stops:particular-bus' vehicle_id='DL1PC4105' %}",
                            //   var datapoints = new L.GeoJSON.AJAX("{% url 'stops:all-buses' %}",
                {
			pointToLayer: function (feature, latlng) {
                return L.marker(latlng, {
                    icon: L.icon({
                        // iconUrl: "static/img/bus_blue_point.png",
                        iconUrl: "{% static 'img/bus_blue_point.png' %}",
                        iconSize: [24, 28],
                        iconAnchor: [12, 28],
                        popupAnchor: [0, -25]
                    }),
                    // title: feature.properties.stop_name,
                    title: feature.properties.vehicle_id,

                    riseOnHover: true
                });
            },
			onEachFeature: function(feature,layer){
				// layer.bindPopup(feature.properties.stop_name.toString());
                layer.bindPopup(feature.properties.vehicle_id.toString());
			}
		});
		//datasets.addTo(map);
		datapoints.addTo(map);
            }


            function map_init(map, options) {
                // get point lat and lon
                var lon = "{{ stops.longitude }}";
                var lat = "{{ stops.latitude }}";
                // zoom to point & add it to map
                map.setView([lat, lon], 12);
                L.marker([lat, lon]).addTo(map);
            }           
        </script>
    
        <h1>{{ stops.stop_name }}</h1>
        <h1>{{ buses.vehicle_id}}</h1>

        {% leaflet_map "gis" callback="map_points"  %}
        <!-- {% leaflet_map "main" callback="map_init" %} -->
    <div >
        <form method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <!-- <input type="text"> -->
            <button type="submit">Submit</button>
        </form>
        </div>
    <!-- {% leaflet_map "main" %} -->
</body>
</html>
